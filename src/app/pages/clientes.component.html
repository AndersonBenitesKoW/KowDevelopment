<div class="clientes-container">
  <div class="header">
    <h1>Gestión de Clientes</h1>
    <button class="btn-primary" (click)="toggleForm()">
      {{ showForm ? 'Cancelar' : 'Nuevo Cliente' }}
    </button>
  </div>

  <div class="form-section" *ngIf="showForm">
    <h2>{{ editingCliente ? 'Editar Cliente' : 'Nuevo Cliente' }}</h2>
    <form [formGroup]="clienteForm" (ngSubmit)="onSubmit()">
      <div class="form-row">
        <div class="form-group">
          <label for="nombres">Nombres *</label>
          <input type="text" id="nombres" formControlName="nombres" required>
        </div>
        <div class="form-group">
          <label for="apellidos">Apellidos *</label>
          <input type="text" id="apellidos" formControlName="apellidos" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="documentoIdentidad">Documento de Identidad *</label>
          <input type="text" id="documentoIdentidad" formControlName="documentoIdentidad" required>
        </div>
        <div class="form-group">
          <label for="email">Email *</label>
          <input type="email" id="email" formControlName="email" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="telefono">Teléfono</label>
          <input type="tel" id="telefono" formControlName="telefono">
        </div>
        <div class="form-group">
          <label for="empresa">Empresa</label>
          <input type="text" id="empresa" formControlName="empresa">
        </div>
      </div>

      <h3>Dirección</h3>
      <div class="form-row">
        <div class="form-group">
          <label for="pais">País</label>
          <input type="text" id="pais" formControlName="pais">
        </div>
        <div class="form-group">
          <label for="ciudad">Ciudad</label>
          <input type="text" id="ciudad" formControlName="ciudad">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="distrito">Distrito</label>
          <input type="text" id="distrito" formControlName="distrito">
        </div>
        <div class="form-group">
          <label for="linea">Dirección</label>
          <input type="text" id="linea" formControlName="linea">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary" [disabled]="clienteForm.invalid || loading">
          {{ loading ? 'Guardando...' : (editingCliente ? 'Actualizar' : 'Crear') }}
        </button>
        <button type="button" class="btn-secondary" (click)="resetForm()">Cancelar</button>
      </div>
    </form>
  </div>

  <div class="clientes-list">
    <h2>Lista de Clientes</h2>
    <div class="loading" *ngIf="loading && clientes.length === 0">Cargando clientes...</div>

    <div class="cliente-card" *ngFor="let cliente of clientes">
      <div class="cliente-info">
        <h3>{{ cliente.nombres }} {{ cliente.apellidos }}</h3>
        <p><strong>Email:</strong> {{ cliente.email }}</p>
        <p><strong>Teléfono:</strong> {{ cliente.telefono || 'No especificado' }}</p>
        <p><strong>Empresa:</strong> {{ cliente.empresa || 'No especificada' }}</p>
        <p><strong>Documento:</strong> {{ cliente.documentoIdentidad }}</p>
        <div class="direccion" *ngIf="cliente.direccion.linea">
          <p><strong>Dirección:</strong> {{ cliente.direccion.linea }}, {{ cliente.direccion.distrito }}, {{ cliente.direccion.ciudad }}, {{ cliente.direccion.pais }}</p>
        </div>
      </div>
      <div class="cliente-actions">
        <button class="btn-edit" (click)="editCliente(cliente)">Editar</button>
        <button class="btn-delete" (click)="deleteCliente(cliente.id!)">Eliminar</button>
      </div>
    </div>

    <div class="no-clientes" *ngIf="!loading && clientes.length === 0">
      No hay clientes registrados.
    </div>
  </div>
</div>